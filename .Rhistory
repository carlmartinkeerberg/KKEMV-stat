View(tmp)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
name="name"
diff="diff"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = data.frame()
for (r in 1:5){
eval(parse(text=paste("r1_diff=merge(kindness_", r, "1, kindness_", r, "2, kindness_", r, "3, by=name, all=T)", sep="")))
}
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
name="name"
diff="diff"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = data.frame()
for (r in 1:5){
eval(parse(text=paste("r1_diff=merge(kindness_", r, "1, kindness_", r, "2, kindness_", r, "3, by="name", all=T)", sep="")))
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
name="name"
diff="diff"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = data.frame()
name="name"
for (r in 1:5){
eval(parse(text=paste("r1_diff=merge(kindness_", r, "1, kindness_", r, "2, kindness_", r, "3, by=", name, ", all=T)", sep="")))
}
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
name="name"
diff="diff"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = data.frame()
for (r in 1:5){
eval(parse(text=paste("r1_diff=merge(kindness_", r, "1, kindness_", r, "2, kindness_", r, "3, by=""name"", all=T)", sep="")))
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
name="name"
diff="diff"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = data.frame()
for (r in 1:5){
eval(parse(text=paste("r1_diff=merge(kindness_", r, "1, kindness_", r, "2, kindness_", r, "3, by="""name""", all=T)", sep="")))
r1_diff = merge(kindness_11, kindness_21, kindness_12, kindness_13, by="name", all=T)
View(kindness_11)
r1_diff = merge(kindness_11, kindness_12, kindness_13, by="name", all=T)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
r1_diff = merge(kindness_11, kindness_12, kindness_13, by="name", all=T)
r1_diff = merge(kindness_11, kindness_12, kindness_13, by=name, all=T)
r1_diff = merge(kindness_11, kindness_12, by="name", all=T)
View(r1_diff)
r1_diff = merge(r1_diff, kindness_13, by="name", all=T)
View(r1_diff)
r1_diff = Reduce(function(x, y) merge(x, y, by="name", all=TRUE), list(kindness_11, kindness_12, kindness_13))
View(r1_diff)
r1_diff_new = Reduce(function(x, y) merge(x, y, by="name", all=TRUE), list(kindness_11, kindness_12, kindness_13))
View(r1_diff_new)
r1_diff_new = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13))
View(r1_diff_new)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
r1_diff_new = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13,
kindness_21, kindness_22, kindness_23,
kindness_31, kindness_32, kindness_33,
kindness_41, kindness_42, kindness_43,
kindness_51, kindness_52, kindness_53))
View(r1_diff_new)
diffs = aggregate(.~name, diffs, mean)
rm(name)
diffs = aggregate(.~name, diffs, mean)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13,
kindness_21, kindness_22, kindness_23,
kindness_31, kindness_32, kindness_33,
kindness_41, kindness_42, kindness_43,
kindness_51, kindness_52, kindness_53))
rm(name)
diffs = aggregate(.~name, diffs, mean)
View(diffs)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13,
kindness_21, kindness_22, kindness_23,
kindness_31, kindness_32, kindness_33,
kindness_41, kindness_42, kindness_43,
kindness_51, kindness_52, kindness_53))
#rm(name)
diffs = aggregate(.~name, diffs, mean)
View(diffs)
tab = read.csv("https://github.com/carlmartinkeerberg/KKEMV-stat/raw/master/IIetapp.csv",
header = F,
sep = ";",
encoding = "UTF-8",
dec = ".",
stringsAsFactors = F)
speakers = data.frame(tab[c(2:63),])
names(speakers) = c(tab[c(1), ])
teams = data.frame(tab[c(65:82), c(1:27)])
names(teams) = c(tab[c(64), c(1:27)])
judges = data.frame(tab[c(84:106), c(1:21)])
names(judges) = c(tab[c(83), c(1:21)])
totalspeakers = na.omit(data.frame(speakers$SPEAKER, as.numeric(speakers$TOTALAVG)))
bestspeaker = totalspeakers[which.max(totalspeakers$as.numeric.speakers.TOTALAVG.),]
print(bestspeaker)
alltotalavg = na.omit(as.numeric(speakers$TOTALAVG))
meantotalavg = mean(na.omit(as.numeric(speakers$TOTALAVG)))
hist(alltotalavg,
main = "Keskmised spiikripunktid",
xlab = "Punktid",
ylab = "Sagedus",
xlim = c(60, 80),
breaks = 6)
abline(v = meantotalavg,
col = "blue",
lwd = 2.5)
legend(73, 20,
c("Aritm keskmine"),
lwd = c(2.5),
col = c("blue"))
r1_ms = mean(na.omit(as.numeric(speakers$R1AVG)))
r2_ms = mean(na.omit(as.numeric(speakers$R2AVG)))
r3_ms = mean(na.omit(as.numeric(speakers$R3AVG)))
r4_ms = mean(na.omit(as.numeric(speakers$R4AVG)))
r5_ms = mean(na.omit(as.numeric(speakers$R5AVG)))
mean_speakers = c(r1_ms, r2_ms, r3_ms, r4_ms, r5_ms)
plot(mean_speakers,
main = "Keskmised spiikripunktid läbi voorude",
xlab = "Voor",
ylab = "Punkte",
ylim = c(68, 72),
type = "b")
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13,
kindness_21, kindness_22, kindness_23,
kindness_31, kindness_32, kindness_33,
kindness_41, kindness_42, kindness_43,
kindness_51, kindness_52, kindness_53))
diffs = aggregate(.~name, diffs, mean)
View(diffs)
tab = read.csv("https://github.com/carlmartinkeerberg/KKEMV-stat/raw/master/IIetapp.csv",
header = F,
sep = ";",
encoding = "UTF-8",
dec = ".",
stringsAsFactors = F)
speakers = data.frame(tab[c(2:63),])
names(speakers) = c(tab[c(1), ])
teams = data.frame(tab[c(65:82), c(1:27)])
names(teams) = c(tab[c(64), c(1:27)])
judges = data.frame(tab[c(84:106), c(1:21)])
names(judges) = c(tab[c(83), c(1:21)])
totalspeakers = na.omit(data.frame(speakers$SPEAKER, as.numeric(speakers$TOTALAVG)))
bestspeaker = totalspeakers[which.max(totalspeakers$as.numeric.speakers.TOTALAVG.),]
print(bestspeaker)
alltotalavg = na.omit(as.numeric(speakers$TOTALAVG))
meantotalavg = mean(na.omit(as.numeric(speakers$TOTALAVG)))
hist(alltotalavg,
main = "Keskmised spiikripunktid",
xlab = "Punktid",
ylab = "Sagedus",
xlim = c(60, 80),
breaks = 6)
abline(v = meantotalavg,
col = "blue",
lwd = 2.5)
legend(73, 20,
c("Aritm keskmine"),
lwd = c(2.5),
col = c("blue"))
r1_ms = mean(na.omit(as.numeric(speakers$R1AVG)))
r2_ms = mean(na.omit(as.numeric(speakers$R2AVG)))
r3_ms = mean(na.omit(as.numeric(speakers$R3AVG)))
r4_ms = mean(na.omit(as.numeric(speakers$R4AVG)))
r5_ms = mean(na.omit(as.numeric(speakers$R5AVG)))
mean_speakers = c(r1_ms, r2_ms, r3_ms, r4_ms, r5_ms)
plot(mean_speakers,
main = "Keskmised spiikripunktid läbi voorude",
xlab = "Voor",
ylab = "Punkte",
ylim = c(68, 72),
type = "b")
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13,
kindness_21, kindness_22, kindness_23,
kindness_31, kindness_32, kindness_33,
kindness_41, kindness_42, kindness_43,
kindness_51, kindness_52, kindness_53))
diffs = aggregate(.~name, diffs, mean)
View(diffs)
kable(diffs, caption = "Kohtuniku keskmine kõrvalekalle kõneleja keskmistest spiikritest")
library(knitr)
kable(diffs, caption = "Kohtuniku keskmine kõrvalekalle kõneleja keskmistest spiikritest")
diffs = Reduce(function(x, y) merge(x, y, by="name", all=TRUE), list(kindness_11, kindness_12, kindness_13,
View(diffs)
View(diffs)
View(diffs)
View(diffs)
diffs = Reduce(function(x, y) merge(x, y, by="name", all=TRUE), list(kindness_11, kindness_12, kindness_13,
kindness_21, kindness_22, kindness_23,
kindness_31, kindness_32, kindness_33,
kindness_41, kindness_42, kindness_43,
kindness_51, kindness_52, kindness_53))
View(diffs)
diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13,
kindness_21, kindness_22, kindness_23,
kindness_31, kindness_32, kindness_33,
kindness_41, kindness_42, kindness_43,
kindness_51, kindness_52, kindness_53))
diffs = aggregate(.~name, diffs, mean)
mean(diffs$diff)
library(knitr)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
View(kindness_53)
View(kindness_11)
View(kindness_12)
View(kindness_13)
View(kindness_21)
View(kindness_22)
View(kindness_23)
View(kindness_31)
View(kindness_33)
View(kindness_41)
tmp1=data.frame(c(1,1,1,1), c(3,3,3,3))
tmp1
View(tmp1)
names(tmp1) = c("a", "b")
tmp2 = data.frame(c(4,4,4,4) c(7,7,7,7))
tmp2=data.frame(c(4,4,4,4), c(7,7,7,7))
names(tmp2)=c("a", "b")
tmp2
tmp = Reduce(function(x, y) merge(x,y,all=TRUE), list(tmp1, tmp2))
tmp
tmp=aggregate(.~a,tmp,mean)
tmp
tab = read.csv("https://github.com/carlmartinkeerberg/KKEMV-stat/raw/master/Ietapp.csv",
header = F,
sep = ";",
encoding = "UTF-8",
dec = ".",
stringsAsFactors = F)
speakers = data.frame(tab[c(2:94),])
names(speakers) = c(tab[c(1), ])
teams = data.frame(tab[c(96:125), c(1:27)])
names(teams) = c(tab[c(95), c(1:27)])
judges = data.frame(tab[c(127:143), c(1:21)])
names(judges) = c(tab[c(126), c(1:21)])
totalspeakers = na.omit(data.frame(speakers$SPEAKER, as.numeric(speakers$TOTALAVG)))
bestspeaker = totalspeakers[which.max(totalspeakers$as.numeric.speakers.TOTALAVG.),]
print(bestspeaker)
alltotalavg = na.omit(as.numeric(speakers$TOTALAVG))
meantotalavg = mean(na.omit(as.numeric(speakers$TOTALAVG)))
hist(alltotalavg,
main = "Keskmised spiikripunktid",
xlab = "Punktid",
ylab = "Sagedus",
xlim = c(60, 80),
breaks = 6)
abline(v = meantotalavg,
col = "blue",
lwd = 2.5)
legend(73, 20,
c("Aritm keskmine"),
lwd = c(2.5),
col = c("blue"))
r1_ms = mean(na.omit(as.numeric(speakers$R1AVG)))
r2_ms = mean(na.omit(as.numeric(speakers$R2AVG)))
r3_ms = mean(na.omit(as.numeric(speakers$R3AVG)))
r4_ms = mean(na.omit(as.numeric(speakers$R4AVG)))
r5_ms = mean(na.omit(as.numeric(speakers$R5AVG)))
mean_speakers = c(r1_ms, r2_ms, r3_ms, r4_ms, r5_ms)
plot(mean_speakers,
main = "Keskmised spiikripunktid läbi voorude",
xlab = "Voor",
ylab = "Punkte",
ylim = c(68, 72),
type = "b")
library(knitr)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
library(knitr)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
View(kindness_11)
View(diffs)
tab = read.csv("https://github.com/carlmartinkeerberg/KKEMV-stat/raw/master/Ietapp.csv",
header = F,
sep = ";",
encoding = "UTF-8",
dec = ".",
stringsAsFactors = F)
speakers = data.frame(tab[c(2:94),])
names(speakers) = c(tab[c(1), ])
library(knitr)
for (r in 1:5){
eval(parse(text=paste("kindness_", r, "=data.frame(as.numeric(speakers$R", r, "J1)- as.numeric(speakers$TOTALAVG), speakers$R", r, "J1NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, ")=c(", diff, ",", name, ")", sep="")))
}
diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_1, kindness_2, kindness_3, kindness_4, kindness_5))
diffs = aggregate(.~name, diffs, mean)
kable(diffs, caption = "Kohtuniku keskmine kõrvalekalle kõneleja keskmistest spiikritest")
View(diffs)
judges = data.frame(tab[c(127:143), c(1:21)])
names(judges) = c(tab[c(126), c(1:21)])
View(judges)
View(speakers)
library(knitr)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
tab = read.csv("https://github.com/carlmartinkeerberg/KKEMV-stat/raw/master/IIetapp.csv",
header = F,
sep = ";",
encoding = "UTF-8",
dec = ".",
stringsAsFactors = F)
speakers = data.frame(tab[c(2:63),])
names(speakers) = c(tab[c(1), ])
library(knitr)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13,
kindness_21, kindness_22, kindness_23,
kindness_31, kindness_32, kindness_33,
kindness_41, kindness_42, kindness_43,
kindness_51, kindness_52, kindness_53))
diffs = aggregate(.~name, diffs, mean)
kable(diffs, caption = "Kohtuniku keskmine kõrvalekalle kõneleja keskmistest spiikritest")
library(knitr)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="Erinevus"
name="Kohtunik"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
library(knitr)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="Erinevus"
name="Kohtunik"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
library(knitr)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13,
kindness_21, kindness_22, kindness_23,
kindness_31, kindness_32, kindness_33,
kindness_41, kindness_42, kindness_43,
kindness_51, kindness_52, kindness_53))
diffs = aggregate(.~name, diffs, mean)
kable(diffs, caption = "Kohtuniku keskmine kõrvalekalle kõneleja keskmistest spiikritest")
library(knitr)
for (r in 1:5){
for (j in 1:3){
eval(parse(text=paste("kindness_", r, j, "=data.frame(as.numeric(speakers$R", r, "J", j, ")- as.numeric(speakers$TOTALAVG), speakers$R", r, "J", j, "NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, j, ")=c(", diff, ",", name, ")", sep="")))
eval(parse(text=paste("kindness_", r, j, "=aggregate(. ~", name, ", kindness_", r, j, ", mean)", sep="")))
}
}
diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13,
kindness_21, kindness_22, kindness_23,
kindness_31, kindness_32, kindness_33,
kindness_41, kindness_42, kindness_43,
kindness_51, kindness_52, kindness_53))
diffs = aggregate(.~name, diffs, mean)
names(diffs) = c("Kohtunik", "Erinevus")
kable(diffs, caption = "Kohtuniku keskmine kõrvalekalle kõneleja keskmistest spiikritest")
tab = read.csv("c:/Users/carlm/Desktop/tab.csv",
header = F,
sep = ";",
encoding = "UTF-8",
dec = ".",
stringsAsFactors = F)
View(tab)
speakers = data.frame(tab[c(2:49),])
names(speakers) = c(tab[c(1), ])
View(speakers)
library(knitr)
for (r in 1:5){
eval(parse(text=paste("kindness_", r, "=data.frame(as.numeric(speakers$R", r, "J1)- as.numeric(speakers$TOTALAVG), speakers$R", r, "J1NAME)", sep="")))
diff="diff"
name="name"
eval(parse(text=paste("names(kindness_", r, ")=c(", diff, ",", name, ")", sep="")))
}
diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_1, kindness_2, kindness_3, kindness_4, kindness_5))
diffs = aggregate(.~name, diffs, mean)
kable(diffs, caption = "Kohtuniku keskmine kõrvalekalle kõneleja keskmistest spiikritest")
