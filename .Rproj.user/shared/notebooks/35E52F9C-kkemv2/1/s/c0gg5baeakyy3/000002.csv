"0","library(knitr)"
"0","for (r in 1:5){"
"0","  for (j in 1:3){"
"0","    eval(parse(text=paste(""kindness_"", r, j, ""=data.frame(as.numeric(speakers$R"", r, ""J"", j, "")- as.numeric(speakers$TOTALAVG), speakers$R"", r, ""J"", j, ""NAME)"", sep="""")))"
"0","    diff=""diff"""
"0","    name=""name"""
"0","    eval(parse(text=paste(""names(kindness_"", r, j, "")=c("", diff, "","", name, "")"", sep="""")))"
"0","    eval(parse(text=paste(""kindness_"", r, j, ""=aggregate(. ~"", name, "", kindness_"", r, j, "", mean)"", sep="""")))"
"0","  }"
"0","}"
"0","diffs = Reduce(function(x, y) merge(x, y, all=TRUE), list(kindness_11, kindness_12, kindness_13,"
"0","                                                                kindness_21, kindness_22, kindness_23,"
"0","                                                                kindness_31, kindness_32, kindness_33,"
"0","                                                                kindness_41, kindness_42, kindness_43,"
"0","                                                                kindness_51, kindness_52, kindness_53))"
"0","diffs = aggregate(.~name, diffs, mean)"
"0","names(diffs) = c(""Kohtunik"", ""Erinevus"")"
"0","diffs = diffs[order(diffs$Erinevus),]"
"0","rownames(diffs) = c()"
"0","speaker_sd = sd(as.numeric(speakers$TOTALAVG), na.rm=T)"
"0","diffs$diff_div_sd = diffs$Erinevus/speaker_sd"
"0","kable(diffs, caption = ""Kohtuniku keskmine kõrvalekalle kõneleja keskmistest spiikritest"")"
